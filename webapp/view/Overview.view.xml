<mvc:View
    controllerName="sap.training.exc.controller.Overview"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.ui.layout.form"
    xmlns:core="sap.ui.core"
    core:require="{ formatter: 'sap/training/exc/model/formatter' }">

    <Page title="{i18n>overviewPageTitle}">
        <content>

            <!-- ================= CUSTOMER FORM ================= -->
            <Panel
                headerText="{i18n>customerPanelHeader}"
                expandable="true"
                expanded="true"
                class="sapUiResponsiveMargin"
                width="auto">

                <content>
                    <f:SimpleForm layout="ColumnLayout" editable="true">

                        <f:toolbar>
                            <Toolbar>
                                <ToolbarSpacer/>
                                <Button
                                    icon="sap-icon://create"
                                    text="{i18n>newCustomerButtonText}"
                                    press=".onSave"
                                    enabled="{= !!${customer>/CustomerName} }"/>
                            </Toolbar>
                        </f:toolbar>

                        <f:content>
                            <core:Title text="{i18n>generalDataFormContainerTitle}"/>

                            <Label text="{i18n>nameLabelText}"/>
                            <Input value="{customer>/CustomerName}" valueLiveUpdate="true"/>

                            <Label text="{i18n>discountLabelText}"/>
                            <Input
                                value="{
                                    path: 'customer>/Discount',
                                    type: 'sap.ui.model.type.Integer',
                                    constraints: { minimum: 0, maximum: 100 }
                                }"/>

                            <core:Title text="{i18n>addressDataFormContainerTitle}"/>

                            <Label text="{i18n>streetLabelText}"/>
                            <Input value="{customer>/Street}"/>

                            <Label text="{i18n>postcodeLabelText}"/>
                            <Input value="{customer>/PostCode}"/>

                            <Label text="{i18n>cityLabelText}"/>
                            <Input value="{customer>/City}"/>

                            <Label text="{i18n>countryLabelText}"/>
                            <Input value="{customer>/Country}"/>
                        </f:content>

                    </f:SimpleForm>
                </content>
            </Panel>

            <!-- ================= CUSTOMER TABLE ================= -->
            <Table
                id="customerTable"
                items="{/Customers}"
                mode="SingleSelectLeft"
                selectionChange=".onCustomerChange"
                growing="true"
                class="sapUiResponsiveMargin">

                <headerToolbar>
                    <Toolbar>
                        <Title text="{i18n>customerTableHeader}"/>
                        <ToolbarSpacer/>
                        <SearchField search=".onFilterCustomers"/>
                    </Toolbar>
                </headerToolbar>

                <columns>
                    <Column><Text text="{i18n>nameLabelText}"/></Column>
                    <Column><Text text="{i18n>cityLabelText}"/></Column>
                    <Column><Text text="{i18n>countryLabelText}"/></Column>
                </columns>

                <items>
                    <ColumnListItem>
                        <cells>
                            <ObjectIdentifier title="{CustomerName}"/>
                            <Text text="{City}"/>
                            <Text text="{Country}"/>
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>

            <!-- ================= BOOKINGS TABLE ================= -->
            <Table
                id="bookingTable"
                headerText="{i18n>bookingTableHeader}"
                items="{_Bookings}"
                growing="true"
                class="sapUiResponsiveMargin">

                <columns>
                    <Column><Text text="{i18n>airlineColumnHeader}"/></Column>
                    <Column><Text text="{i18n>connectionColumnHeader}"/></Column>
                    <Column><Text text="{i18n>fldateColumnHeader}"/></Column>
                    <Column><Text text="{i18n>classColumnHeader}"/></Column>
                    <Column><Text text="{i18n>paymentColumnHeader}"/></Column>
                    <Column><Text text="{i18n>cancellationColumnHeader}"/></Column>
                </columns>

                <items>
                    <ColumnListItem>
                        <cells>
                            <Text text="{AirlineID}"/>
                            <Text text="{ConnectionNumber}"/>

                            <Text
                                text="{ path: 'FlightDate', formatter: 'formatter.formatFlightDate' }"/>

                            <Text
                                text="{ path: 'Class', formatter: 'formatter.classText' }"/>

                            <ObjectNumber
                                number="{
                                    parts: [
                                        { path: 'ForeignCurrencyPayment' },
                                        { path: 'ForeignCurrency' }
                                    ],
                                    type: 'sap.ui.model.type.Currency',
                                    formatOptions: { showMeasure: false }
                                }"
                                unit="{ForeignCurrency}"/>

                            <core:Icon
                                src="{= ${IsCancelled} === 'X'
                                    ? 'sap-icon://cancel'
                                    : 'sap-icon://accept' }"
                                tooltip="{ path: 'IsCancelled',
                                    formatter: 'formatter.cancellationTooltip' }"/>
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>

        </content>
    </Page>
</mvc:View>
